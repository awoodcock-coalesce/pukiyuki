steps:
  STG_ORDERS_LINEITEM_DIM_LOOKUP-83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: TARGET
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 026a85cf-c7b6-4530-a819-e9a29f4166c2
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 28f743a5-771b-479f-921a-a65ca4a8ddef
                    stepCounter: a8a9d5c1-007a-4111-99f6-b7b00e38b924
                transform: ""
          - columnReference:
              columnCounter: 5372ecaa-d289-4b40-827e-1bf62b65cdca
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a60f5423-bcff-43bc-915e-44810978383c
                    stepCounter: 879b9723-337b-4544-9830-73fa41e0a04f
                transform: ""
          - columnReference:
              columnCounter: 4fcd9753-6d8c-46ea-84f3-3ed0bc9bef66
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8ea68f7d-3891-4469-a24a-70cf2b173ee5
                    stepCounter: 3f5cbd25-b752-449b-b981-b9e872e7870d
                transform: ""
          - columnReference:
              columnCounter: bb6eb060-69e7-4872-8796-afdd4d6db881
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(38,0)
            description: ""
            name: O_CUSTKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a3e11c3e-f3ab-423d-a012-5adba5a7f701
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: ea238130-2a93-4627-b43f-a013535e069e
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(38,0)
            description: ""
            name: L_PARTKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e4946a6c-856d-4cff-b178-77a0fdb09d3a
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: d1f1a140-641f-458c-a83b-4504ac698b6a
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(38,0)
            description: ""
            name: L_SUPPKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 061799b4-f3e4-469e-9fac-20695a1687eb
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: d23c4b59-4921-4517-a73a-5a68d6de64c6
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(38,0)
            description: ""
            name: O_ORDERKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 831d9e3b-4f31-4c42-be5e-e44a60740ed7
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: f7818589-a8f5-4f7f-b3c8-c24d3455358d
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(1)
            description: ""
            name: O_ORDERSTATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a3de2106-1625-4e8f-91b5-04a49c1d55a5
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 9557040a-90d9-44b2-b99b-adf02b8b0daf
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(12,2)
            description: ""
            name: O_TOTALPRICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f74cc15a-6157-47da-a8f5-0c224cbff319
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: e532ebbb-9d85-40f3-a6a6-342cfc8647c5
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: DATE
            description: ""
            name: O_ORDERDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f532a2f8-9805-4381-8c0f-97fa7ebe5f52
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 620b12c5-6cc6-4029-96e7-d24a6e7f78e5
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(15)
            description: ""
            name: O_ORDERPRIORITY_NUM
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ab94efb3-6d01-4822-a3d3-d86878f4de99
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 15d100bf-1b83-4dce-8d63-64cc75ae1867
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(15)
            description: ""
            name: O_ORDERPRIORITY_DESC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2b190bd7-c9ff-45d9-a20f-f5775f468a39
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: cd335aae-3349-4691-8dc3-1946b1b89559
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(15)
            description: ""
            name: O_CLERK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5d42ff11-34ae-4cf9-8213-bd8af2bdbef5
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 8164403a-003d-4e24-9aee-11ecaf82c3bd
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(38,0)
            description: ""
            name: O_SHIPPRIORITY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5c8a9607-7bc5-427f-9edd-7953d4a50afc
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: b970f309-c31c-45a1-8e42-c5b04b852d7b
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(79)
            description: ""
            name: O_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 028ec417-c6fc-45dd-a516-fe4f66ac1606
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: ca7bf40a-7154-48e7-9d92-6e3a3e1d8146
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(38,0)
            description: ""
            name: L_ORDERKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cb0d2ab6-35a6-47c1-9e4b-c55b945c4538
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: d43a30a9-b829-4c77-a2c8-8bff9b71ca59
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(38,0)
            description: ""
            name: L_LINENUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 684bb2d1-b979-4778-a9ac-9b308d7c1423
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 0168f353-bbce-47b2-9333-8e14d03ab3b9
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(12,2)
            description: ""
            name: L_QUANTITY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 77f5f582-14cf-4a54-91be-032760d023cf
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 71d09b69-ff14-44a0-a398-7243ced683ba
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(12,2)
            description: ""
            name: L_EXTENDEDPRICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 853060e6-7840-4c58-814b-8c451e9726a1
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: d7cb80ee-8132-4d94-a56a-10651455af05
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(12,2)
            description: ""
            name: L_DISCOUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 487231ed-de92-4413-b437-75dbe5666606
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: d5ec4813-e294-4bff-a010-c9196d6709f7
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(12,2)
            description: ""
            name: L_TAX
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a4b628e0-2e4a-476f-97e0-8bedbfd3c699
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 6a268350-5374-4b40-8a00-bbc8a5d2b461
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(1)
            description: ""
            name: L_RETURNFLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 78fe9f3b-ff59-4501-986c-0c38b868f4d0
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: daffe65d-5ff8-459d-b3be-2abf92fa3803
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(1)
            description: ""
            name: L_LINESTATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1b1861ec-03b9-4ca0-a0f5-d1b1433dd00e
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: d407dea2-14b6-4e54-be6d-f8ed8b2f7521
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: DATE
            description: ""
            name: L_SHIPDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3d3c3fe1-f173-44b8-a4e9-9f89a429e12b
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 6459e4f9-8ff1-468c-a282-2fa1e773b54a
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: DATE
            description: ""
            name: L_COMMITDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ac68bed5-d1b6-4e08-b6cb-b05d6437cadd
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 7b62e8ca-ee7c-428a-afa4-6884542d9d04
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: DATE
            description: ""
            name: L_RECEIPTDATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c1f9af1d-35b5-45b3-aead-8d706d16879b
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: 427a6d28-9023-4e7c-813b-7672289aa79f
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(25)
            description: ""
            name: L_SHIPINSTRUCT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1f8aea91-ddbe-4c25-95ed-ae0ff4e95517
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: f7c9350d-984c-4dcd-95dd-d8d556810f6c
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(10)
            description: ""
            name: L_SHIPMODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cac6474d-1104-4b10-be35-756199a715c9
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: e673e312-a6d4-4bbb-98a4-70f0771cb286
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: VARCHAR(44)
            description: ""
            name: L_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8af3d3a4-b468-4d49-9758-c8e4b23dc69b
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - columnReference:
              columnCounter: b982b0dd-aff3-47f1-8e10-ee3e2b49e3ee
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER
            description: ""
            name: DAYS_TO_SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7d46af29-8063-4d1b-a884-83bc0a31d168
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3ce1ac4b-3347-4431-b64a-ebc127ac0908
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 05632801-913a-4e16-b07a-5561fe4dc634
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: cc2964dc-31d7-4800-9baf-03b74982a153
              stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e8f30833-dda1-40f7-a7a3-0783feed6e71
                    stepCounter: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: a8a9d5c1-007a-4111-99f6-b7b00e38b924
              DIM_PART: 879b9723-337b-4544-9830-73fa41e0a04f
              DIM_SUPPLIER: 3f5cbd25-b752-449b-b981-b9e872e7870d
              STG_ORDERS_LINEITEM: 9a4ddc7f-d0f3-468f-8ddf-46c330c25e07
              STG_PARTSUPP: a832e002-62a2-4aa2-ba74-fcaa42d939a4
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: TARGET
                nodeName: DIM_CUSTOMER
              - locationName: TARGET
                nodeName: DIM_PART
              - locationName: TARGET
                nodeName: DIM_SUPPLIER
              - locationName: TARGET
                nodeName: STG_ORDERS_LINEITEM
              - locationName: TARGET
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('TARGET', 'STG_ORDERS_LINEITEM') }} "STG_ORDERS_LINEITEM"

                LEFT JOIN {{ ref('TARGET', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"

                ON "STG_ORDERS_LINEITEM"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"

                AND "STG_ORDERS_LINEITEM"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"

                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */

                LEFT JOIN {{ ref('TARGET', 'DIM_PART') }} "DIM_PART"

                ON "STG_ORDERS_LINEITEM"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"

                LEFT JOIN {{ ref('TARGET', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"

                ON "STG_ORDERS_LINEITEM"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"

                LEFT JOIN {{ ref('TARGET', 'STG_PARTSUPP') }} "STG_PARTSUPP"

                ON "STG_ORDERS_LINEITEM"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND

                "STG_ORDERS_LINEITEM"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_ORDERS_LINEITEM_DIM_LOOKUP
            noLinkRefs: []
      name: STG_ORDERS_LINEITEM_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 83dd8dbe-9b5d-4d77-82a7-66dd19e3cf38
